.month-calendar-body
    .day-names
        div
            p=Msg.Sunday
        div
            p=Msg.Monday
        div
            p=Msg.Tuesday
        div
            p=Msg.Wednesday
        div
            p=Msg.Thursday
        div
            p=Msg.Friday
        div
            p=Msg.Saturday
    .items
        -selectedItem = self.getTopData() ? self.getTopData().getSelectedItemId() : null
        each item in self.getItems()
            announcements = item.getAnnouncements()
            itemsArr = item.getItemsArray()
            disablePopUp = !self.isMainCalendar() || self.getUserRole().isStudent() && !announcements.length && !itemsArr.length
            +ActionLink('calendar', 'showMonthDayPopUp', item.getDate().toStandardFormat(), selectedItem)(
                class = [item.isSunday() ? 'sunday' : '', item.getClassName(), item.getTodayClassName(), disablePopUp ? 'disabled' : '', itemsArr.length + announcements.length ? 'with-anns' : '']
            )
                h2.number=item.getDay()
                max = 7
                if announcements.length > 0
                    ul(class=item.getRole()).day-announcements.calendar-items
                        each announcement,i in announcements
                            if i < item.getAnnLimit() || announcements.length <= item.getAnnLimit()
                                li(data-tooltip=announcement.getTitle(), data-tooltip-type="overflow").items=announcement.getTitle()
                        if announcements.length > item.getAnnLimit()
                            li +#{announcements.length - item.getAnnLimit() + 1} more
                ul(class=(announcements.length > 0 ? '' : 'calendar-items')).day-items
                    announcementsLen = announcements.length > 3 ? 3 : announcements.length;
                    maxLen = max - announcementsLen;
                    each annItem,i in itemsArr
                        if i < maxLen || itemsArr.length <= maxLen
                            li(data-tooltip=annItem.title, data-tooltip-type="overflow")=annItem.title
                        if itemsArr.length > maxLen
                            li +#{itemsArr.length - maxLen + 1} more